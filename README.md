# GrabberPro
# GraberPro - Telegram Content Bot

Мощный бот для автоматизации работы с контентом в Telegram каналах. Позволяет копировать, фильтровать и обрабатывать сообщения между каналами с множеством полезных функций.

## Основные возможности

### Управление контентом
- **Копирование сообщений** между каналами с сохранением медиа
- **Фильтрация по ключевым словам** (белый и черный списки)
- **Автоматическая замена** ссылок и упоминаний
- **Обрезка текста** по стоп-словам
- **Добавление подписи** к каждому сообщению

### Безопасность и контроль
- **Безопасный режим** с лимитами на количество сообщений
- **Проверка на спам** и нежелательный контент
- **Логирование** всех операций
- **Уведомления** о работе бота

### Дополнительные функции
- **Интеграция с OpenAI** для обработки текста и генерации изображений
- **Работа с альбомами** (группированные медиа)
- **Гибкая настройка** через конфигурационный файл
- **Простое управление** через Telegram команды

## Быстрый старт

### 1. Подготовка

1. **Установите Python 3.7+** на ваш компьютер
2. **Скачайте** все файлы проекта в одну папку
3. **Установите зависимости**:
   ```bash
   pip install telethon aiogram asyncio pickle logging
   ```

### 2. Настройка конфигурации

Откройте файл `config.json` и заполните необходимые данные:

```json
{
    "api_id": "ВАШ_API_ID",
    "api_hash": "ВАШ_API_HASH", 
    "bot_token": "ТОКЕН_ВАШЕГО_БОТА",
    "my_id": ВАШ_TELEGRAM_ID,
    "technical_channel_id": ID_КАНАЛА_ДЛЯ_УВЕДОМЛЕНИЙ,
    "new_link": "http://t.me/ваш_канал",
    "new_username": "@ваш_username"
}
```

#### Где получить данные:
- **API_ID и API_HASH**: https://my.telegram.org/apps
- **Bot Token**: создайте бота через @BotFather
- **Ваш ID**: узнайте через @userinfobot
- **ID канала**: добавьте @userinfobot в канал

### 3. Запуск

```bash
python main.py
```

При первом запуске введите номер телефона и код подтверждения для авторизации Telegram.

## Команды бота

### Основные команды
- `/start` - Запуск бота и главное меню
- `/add_channel` - Добавить новую связку каналов
- `/list_channels` - Показать все настроенные каналы
- `/delete_channel` - Удалить связку каналов

### Управление контентом
- `/last_save` - Скопировать последние сообщения
- `/start_monitoring` - Запустить мониторинг в реальном времени
- `/stop_monitoring` - Остановить мониторинг

### Настройки фильтрации
- `/add_whitelist` - Добавить слова в белый список
- `/show_whitelist` - Показать белый список
- `/clear_whitelist` - Очистить белый список
- `/add_blacklist` - Добавить слова в черный список
- `/show_blacklist` - Показать черный список

### Дополнительные настройки
- `/set_text_end` - Установить подпись для сообщений
- `/toggle_link_replacement` - Включить/выключить замену ссылок
- `/set_deleting_words` - Установить стоп-слова для обрезки текста
- `/toggle_safe_mode` - Включить/выключить безопасный режим

## Подробное руководство

### Настройка связки каналов

1. Отправьте команду `/add_channel`
2. Введите ID исходного канала (откуда копировать)
3. Введите ID целевого канала (куда копировать)
4. Бот сохранит настройки автоматически

**Важно**: Бот должен быть администратором в обоих каналах!

### Работа с фильтрами

#### Белый список (Whitelist)
Сообщения будут копироваться **только** если содержат слова из белого списка:
- `/add_whitelist` - добавить слова через запятую
- Пример: `скидка, акция, распродажа`

#### Черный список (Blacklist) 
Сообщения **не будут** копироваться если содержат слова из черного списка:
- `/add_blacklist` - добавить запрещенные слова
- Пример: `спам, реклама, мошенничество`

### Замена ссылок и упоминаний

1. Включите функцию: `/toggle_link_replacement`
2. В config.json укажите:
   - `new_link` - новая ссылка для замены
   - `new_username` - новый username для замены @упоминаний

### Безопасный режим

Защищает от блокировок Telegram:
- Ограничивает количество сообщений в час
- Автоматически делает паузы
- Настраивается в config.json (`SAFE_MODE_LIMIT`, `TIMEOUT`)

## Расширенные настройки

### Интеграция с OpenAI

Для использования AI-функций добавьте в config.json:
```json
{
    "openai_api_key_gpt": "ваш_ключ_gpt",
    "openai_api_key_dalle": "ваш_ключ_dalle"
}
```

### Логирование

Все действия бота записываются в лог-файлы для отладки и мониторинга.

### Файлы данных

Бот создает служебные файлы:
- `channel_mapping.pickle` - связки каналов
- `white_list.pickle` - белый список
- `blacklist.pickle` - черный список
- `*_text_end.pickle` - подписи для каналов

## Решение проблем

### Частые ошибки

**"FloodWaitError"** - слишком много запросов:
- Включите безопасный режим
- Увеличьте паузы между сообщениями

**"Unauthorized"** - проблемы с авторизацией:
- Проверьте API_ID и API_HASH
- Перезапустите бота для повторной авторизации

**"ChatAdminRequired"** - нет прав администратора:
- Добавьте бота как админа в каналы
- Дайте права на отправку сообщений

### Советы по использованию

1. **Тестируйте на небольших каналах** перед массовым использованием
2. **Регулярно проверяйте логи** на наличие ошибок
3. **Используйте безопасный режим** для больших объемов
4. **Настройте уведомления** для контроля работы бота

## Поддержка

При возникновении проблем:
1. Проверьте логи бота
2. Убедитесь в правильности настроек config.json
3. Проверьте права бота в каналах
4. Попробуйте перезапустить бота командой в чате

---

**Внимание**: Используйте бота ответственно и в соответствии с правилами Telegram. Автор не несет ответственности за нарушение ToS или блокировки аккаунтов.
